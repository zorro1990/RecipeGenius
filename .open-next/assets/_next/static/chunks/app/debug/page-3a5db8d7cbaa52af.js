(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[302],{2796:(e,t,r)=>{"use strict";r.r(t),r.d(t,{API_PROVIDERS:()=>g,clearProviderAPIKey:()=>l,clearStoredAPIKeys:()=>c,getConfiguredProviders:()=>u,getPreferredRecipeProvider:()=>x,getRecipeProviders:()=>p,getStoredAPIKeys:()=>s,hasAnyAPIKey:()=>d,maskAPIKey:()=>i,setPreferredRecipeProvider:()=>f,storeAPIKeys:()=>a,validateAPIKeyFormat:()=>o});let n="recipe-genius-2025";function i(e){if(!e||e.length<8)return"****";let t=e.substring(0,4),r=e.substring(e.length-4);return"".concat(t,"****").concat(r)}function o(e,t){if(!t||0===t.trim().length)return!1;let r=t.trim();switch(e){case"deepseek":case"qwen":return r.startsWith("sk-")&&r.length>20;case"doubao":case"glm":return r.length>10;case"gemini":return r.startsWith("AIza")&&r.length>30;default:return r.length>5}}function a(e){try{let t={};Object.entries(e).forEach(e=>{let[r,i]=e;i&&i.trim()&&(t[r]=function(e){try{return btoa(e).split("").reverse().join("")+"|"+n.length.toString()}catch(t){return e}}(i.trim()))}),localStorage.setItem("recipe-genius-api-keys",JSON.stringify(t))}catch(e){throw console.error("存储API密钥失败:",e),Error("存储API密钥失败")}}function s(){try{let e=localStorage.getItem("recipe-genius-api-keys");if(!e)return{};let t=JSON.parse(e),r={},i=!1;if(Object.entries(t).forEach(e=>{let[t,o]=e;if("string"==typeof o){let e=function(e){try{let t=e.lastIndexOf("|");if(-1===t)return"";let r=e.slice(t+1);if(parseInt(r)!==n.length)return"";let i=e.slice(0,t).split("").reverse().join("");return atob(i)}catch(e){return""}}(o);e?r[t]=e:i=!0}}),i&&0===Object.keys(r).length)return localStorage.removeItem("recipe-genius-api-keys"),{};return r}catch(e){return console.error("读取API密钥失败:",e),localStorage.removeItem("recipe-genius-api-keys"),{}}}function c(){try{localStorage.removeItem("recipe-genius-api-keys")}catch(e){console.error("清除API密钥失败:",e)}}function l(e){try{let t=s();delete t[e],a(t)}catch(t){console.error("清除".concat(e,"API密钥失败:"),t)}}function d(){let e=s(),t=Object.entries(e).some(e=>{let[t,r]=e;return"doubao"!==t&&r&&"string"==typeof r&&r.trim().length>0}),r=e.doubao&&"string"==typeof e.doubao&&e.doubao.trim().length>0;return!!(t||r)}function u(){return Object.entries(s()).filter(e=>{let[t,r]=e;return r&&"string"==typeof r&&r.trim().length>0}).map(e=>{let[t,r]=e;return t})}let g={deepseek:{name:"DeepSeek",description:"性价比之王，价格极低、性能优秀",website:"https://platform.deepseek.com",keyFormat:"sk-xxxxxxxx...",icon:"\uD83D\uDE80",features:["菜谱生成","营养分析"],priority:"推荐",usage:"主要用于菜谱生成，响应快速，成本低廉"},doubao:{name:"豆包 (字节跳动)",description:"国内访问稳定，支持图片识别",website:"https://console.volcengine.com/ark",keyFormat:"xxxxxxxx-xxxx-xxxx...",icon:"\uD83C\uDFAF",requiresEndpoint:!0,features:["图片识别","菜谱生成"],priority:"必需",usage:"图片识别功能必需，也可用于菜谱生成"},qwen:{name:"通义千问 (阿里云)",description:"阿里云生态，企业级稳定性",website:"https://bailian.console.aliyun.com",keyFormat:"sk-xxxxxxxx...",icon:"☁️",features:["菜谱生成"],priority:"备选",usage:"可用于菜谱生成，企业级稳定性"},glm:{name:"智谱AI (ChatGLM)",description:"清华技术，中文优化",website:"https://open.bigmodel.cn",keyFormat:"xxxxxxxx...",icon:"\uD83E\uDDE0",features:["菜谱生成"],priority:"备选",usage:"可用于菜谱生成，中文优化"},gemini:{name:"Google Gemini",description:"Google AI，功能强大（需科学上网）",website:"https://aistudio.google.com/app/apikey",keyFormat:"AIzaxxxxxxxx...",icon:"\uD83C\uDF1F",features:["菜谱生成"],priority:"备选",usage:"可用于菜谱生成，需要科学上网"}};function p(){let e=s(),t=[],r=e.preferredRecipeProvider;return r&&e[r]&&("doubao"===r&&e.doubao&&e.doubaoEndpointId?t.push("doubao"):"doubao"!==r&&e[r]&&t.push(r)),["deepseek","qwen","glm","gemini"].forEach(n=>{n!==r&&e[n]&&t.push(n)}),t}function f(e){try{let t=s();t.preferredRecipeProvider=e,a(t)}catch(e){console.error("设置首选菜谱模型失败:",e)}}function x(){try{return s().preferredRecipeProvider||null}catch(e){return console.error("获取首选菜谱模型失败:",e),null}}},3999:(e,t,r)=>{"use strict";r.d(t,{Hv:()=>l,cn:()=>o,hd:()=>a,iX:()=>c,o1:()=>s});var n=r(2596),i=r(9688);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,i.QP)((0,n.$)(t))}function a(e){if(e<60)return"".concat(e,"分钟");let t=Math.floor(e/60),r=e%60;return 0===r?"".concat(t,"小时"):"".concat(t,"小时").concat(r,"分钟")}function s(e){return e.trim().length>0&&e.trim().length<=50}function c(e){return e.map(e=>e.trim()).filter(e=>s(e)).filter((e,t,r)=>r.indexOf(e)===t)}function l(e){let t=30*Math.min(e.protein/20,1),r=20*Math.min(e.fiber/10,1);return Math.round(t+r+(e.calories>800?0:(800-e.calories)/800*30)+(e.fat>30?0:(30-e.fat)/30*20))}},7168:(e,t,r)=>{"use strict";r.d(t,{$:()=>c});var n=r(5155);r(2115);var i=r(9708),o=r(2085),a=r(3999);let s=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function c(e){let{className:t,variant:r,size:o,asChild:c=!1,...l}=e,d=c?i.DX:"button";return(0,n.jsx)(d,{"data-slot":"button",className:(0,a.cn)(s({variant:r,size:o,className:t})),...l})}},7821:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var n=r(5155),i=r(2115),o=r(7168),a=r(8482),s=r(2796);function c(){let[e,t]=(0,i.useState)(""),r=async()=>{try{t("开始测试API调用...");let e=await fetch("/api/generate-recipe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ingredients:["土豆","胡萝卜"],preferences:{dietaryRestrictions:[],cuisineType:[],cookingTime:30,servings:2,difficulty:"easy",allergies:[]},apiKeys:(0,s.getStoredAPIKeys)()})}),r=await e.json();t("\nAPI调用结果:\n- 状态码: ".concat(e.status,"\n- 响应: ").concat(JSON.stringify(r,null,2),"\n      "))}catch(e){t("API调用失败: ".concat(e))}};return(0,n.jsx)("div",{className:"container mx-auto p-8 max-w-4xl",children:(0,n.jsxs)(a.Zp,{children:[(0,n.jsx)(a.aR,{children:(0,n.jsx)(a.ZB,{children:"调试工具"})}),(0,n.jsxs)(a.Wu,{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex gap-4",children:[(0,n.jsx)(o.$,{onClick:()=>{let e=(0,s.hasAnyAPIKey)(),r=(0,s.getStoredAPIKeys)();t("\nAPI密钥检测结果:\n- hasAnyAPIKey(): ".concat(e,"\n- 存储的密钥: ").concat(JSON.stringify(r,null,2),"\n    "))},children:"测试API密钥"}),(0,n.jsx)(o.$,{onClick:r,children:"测试API调用"})]}),e&&(0,n.jsx)("div",{className:"bg-gray-100 p-4 rounded-lg",children:(0,n.jsx)("pre",{className:"whitespace-pre-wrap text-sm",children:e})})]})]})})}},8482:(e,t,r)=>{"use strict";r.d(t,{BT:()=>c,Wu:()=>l,ZB:()=>s,Zp:()=>o,aR:()=>a});var n=r(5155);r(2115);var i=r(3999);function o(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card",className:(0,i.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...r})}function a(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-header",className:(0,i.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...r})}function s(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-title",className:(0,i.cn)("leading-none font-semibold",t),...r})}function c(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-description",className:(0,i.cn)("text-muted-foreground text-sm",t),...r})}function l(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-content",className:(0,i.cn)("px-6",t),...r})}},9100:(e,t,r)=>{Promise.resolve().then(r.bind(r,7821))}},e=>{var t=t=>e(e.s=t);e.O(0,[352,441,684,358],()=>t(9100)),_N_E=e.O()}]);