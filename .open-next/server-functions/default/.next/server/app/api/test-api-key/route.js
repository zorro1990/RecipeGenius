(()=>{var e={};e.id=967,e.ids=[967],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1974:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>y,routeModule:()=>g,serverHooks:()=>f,workAsyncStorage:()=>k,workUnitAsyncStorage:()=>w});var s={};r.r(s),r.d(s,{GET:()=>m,POST:()=>c});var o=r(6559),a=r(8088),n=r(7719),i=r(2190);async function c(e){try{let{provider:t,apiKey:r,endpointId:s}=await e.json();if(!t||!r)return i.NextResponse.json({success:!1,error:"缺少必要参数"},{status:400});let o=!1,a="";try{switch(t){case"deepseek":o=await u(r);break;case"doubao":if(!s){a="豆包需要提供端点ID";break}o=await p(r,s);break;case"qwen":o=await l(r);break;case"glm":o=await d(r);break;case"gemini":o=await h(r);break;default:a="不支持的提供商"}}catch(e){console.error(`测试${t}API失败:`,e),a=e instanceof Error?e.message:"测试失败"}if(o)return i.NextResponse.json({success:!0,message:`${t} API密钥验证成功`});return i.NextResponse.json({success:!1,error:a||"API密钥验证失败"},{status:400})}catch(e){return console.error("API密钥测试错误:",e),i.NextResponse.json({success:!1,error:"服务器错误"},{status:500})}}async function u(e){if(!e.startsWith("sk-")||e.length<20)throw Error("DeepSeek API密钥格式错误，必须以sk-开头且长度超过20个字符");let t=await fetch("https://api.deepseek.com/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({model:"deepseek-chat",messages:[{role:"user",content:"测试"}],max_tokens:10}),signal:AbortSignal.timeout(15e3)});if(!t.ok){let e=await t.text();if(console.error("❌ DeepSeek API错误:",e),401===t.status)if(e.includes("Multiple 401 errors detected"))throw Error("API密钥验证失败次数过多，请等待1分钟后重试");else throw Error("API密钥无效，请检查密钥是否正确");throw Error(`DeepSeek API错误 (${t.status}): ${e}`)}return await t.json(),!0}async function p(e,t){let r=await fetch("https://ark.cn-beijing.volces.com/api/v3/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({model:t,messages:[{role:"user",content:"测试"}],max_tokens:10}),signal:AbortSignal.timeout(15e3)});if(!r.ok){let e=await r.text();throw console.error("❌ 豆包API错误:",e),Error(`豆包API错误 (${r.status}): ${e}`)}return await r.json(),!0}async function l(e){let t=await fetch("https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({model:"qwen-turbo",input:{messages:[{role:"user",content:"测试"}]},parameters:{max_tokens:10}}),signal:AbortSignal.timeout(15e3)});if(!t.ok){let e=await t.text();throw console.error("❌ 通义千问API错误:",e),Error(`通义千问API错误 (${t.status}): ${e}`)}return await t.json(),!0}async function d(e){let t=await fetch("https://open.bigmodel.cn/api/paas/v4/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({model:"glm-4-flash",messages:[{role:"user",content:"测试"}],max_tokens:10}),signal:AbortSignal.timeout(15e3)});if(!t.ok){let e=await t.text();throw console.error("❌ 智谱AI API错误:",e),Error(`智谱AI API错误 (${t.status}): ${e}`)}return await t.json(),!0}async function h(e){let t=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:"测试"}]}]}),signal:AbortSignal.timeout(15e3)});if(!t.ok){let e=await t.text();throw console.error("❌ Gemini API错误:",e),Error(`Gemini API错误 (${t.status}): ${e}`)}return await t.json(),!0}async function m(){return i.NextResponse.json({success:!1,error:"不支持的请求方法"},{status:405})}let g=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/test-api-key/route",pathname:"/api/test-api-key",filename:"route",bundlePath:"app/api/test-api-key/route"},resolvedPagePath:"/Users/zorro/Documents/augment-projects/cooker/recipe-genius/app/api/test-api-key/route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:k,workUnitAsyncStorage:w,serverHooks:f}=g;function y(){return(0,n.patchFetch)({workAsyncStorage:k,workUnitAsyncStorage:w})}},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6487:()=>{},8335:()=>{},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,580],()=>r(1974));module.exports=s})();