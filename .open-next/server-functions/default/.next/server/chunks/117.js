exports.id=117,exports.ids=[117],exports.modules={350:(e,t,r)=>{"use strict";r.r(t),r.d(t,{API_PROVIDERS:()=>d,clearProviderAPIKey:()=>l,clearStoredAPIKeys:()=>c,getConfiguredProviders:()=>p,getPreferredRecipeProvider:()=>f,getRecipeProviders:()=>m,getStoredAPIKeys:()=>a,hasAnyAPIKey:()=>u,maskAPIKey:()=>n,setPreferredRecipeProvider:()=>g,storeAPIKeys:()=>s,validateAPIKeyFormat:()=>i});let o="recipe-genius-2025";function n(e){if(!e||e.length<8)return"****";let t=e.substring(0,4),r=e.substring(e.length-4);return`${t}****${r}`}function i(e,t){if(!t||0===t.trim().length)return!1;let r=t.trim();switch(e){case"deepseek":case"qwen":return r.startsWith("sk-")&&r.length>20;case"doubao":case"glm":return r.length>10;case"gemini":return r.startsWith("AIza")&&r.length>30;default:return r.length>5}}function s(e){try{let t={};Object.entries(e).forEach(([e,r])=>{r&&r.trim()&&(t[e]=function(e){try{return btoa(e).split("").reverse().join("")+"|"+o.length.toString()}catch{return e}}(r.trim()))}),localStorage.setItem("recipe-genius-api-keys",JSON.stringify(t))}catch(e){throw console.error("存储API密钥失败:",e),Error("存储API密钥失败")}}function a(){try{let e=localStorage.getItem("recipe-genius-api-keys");if(!e)return{};let t=JSON.parse(e),r={},n=!1;if(Object.entries(t).forEach(([e,t])=>{if("string"==typeof t){let i=function(e){try{let t=e.lastIndexOf("|");if(-1===t)return"";let r=e.slice(t+1);if(parseInt(r)!==o.length)return"";let n=e.slice(0,t).split("").reverse().join("");return atob(n)}catch(e){return""}}(t);i?r[e]=i:n=!0}}),n&&0===Object.keys(r).length)return localStorage.removeItem("recipe-genius-api-keys"),{};return r}catch(e){return console.error("读取API密钥失败:",e),localStorage.removeItem("recipe-genius-api-keys"),{}}}function c(){try{localStorage.removeItem("recipe-genius-api-keys")}catch(e){console.error("清除API密钥失败:",e)}}function l(e){try{let t=a();delete t[e],s(t)}catch(t){console.error(`清除${e}API密钥失败:`,t)}}function u(){let e=a(),t=Object.entries(e).some(([e,t])=>"doubao"!==e&&t&&"string"==typeof t&&t.trim().length>0),r=e.doubao&&"string"==typeof e.doubao&&e.doubao.trim().length>0;return!!(t||r)}function p(){return Object.entries(a()).filter(([e,t])=>t&&"string"==typeof t&&t.trim().length>0).map(([e,t])=>e)}let d={deepseek:{name:"DeepSeek",description:"性价比之王，价格极低、性能优秀",website:"https://platform.deepseek.com",keyFormat:"sk-xxxxxxxx...",icon:"\uD83D\uDE80",features:["菜谱生成","营养分析"],priority:"推荐",usage:"主要用于菜谱生成，响应快速，成本低廉"},doubao:{name:"豆包 (字节跳动)",description:"国内访问稳定，支持图片识别",website:"https://console.volcengine.com/ark",keyFormat:"xxxxxxxx-xxxx-xxxx...",icon:"\uD83C\uDFAF",requiresEndpoint:!0,features:["图片识别","菜谱生成"],priority:"必需",usage:"图片识别功能必需，也可用于菜谱生成"},qwen:{name:"通义千问 (阿里云)",description:"阿里云生态，企业级稳定性",website:"https://bailian.console.aliyun.com",keyFormat:"sk-xxxxxxxx...",icon:"☁️",features:["菜谱生成"],priority:"备选",usage:"可用于菜谱生成，企业级稳定性"},glm:{name:"智谱AI (ChatGLM)",description:"清华技术，中文优化",website:"https://open.bigmodel.cn",keyFormat:"xxxxxxxx...",icon:"\uD83E\uDDE0",features:["菜谱生成"],priority:"备选",usage:"可用于菜谱生成，中文优化"},gemini:{name:"Google Gemini",description:"Google AI，功能强大（需科学上网）",website:"https://aistudio.google.com/app/apikey",keyFormat:"AIzaxxxxxxxx...",icon:"\uD83C\uDF1F",features:["菜谱生成"],priority:"备选",usage:"可用于菜谱生成，需要科学上网"}};function m(){let e=a(),t=[],r=e.preferredRecipeProvider;return r&&e[r]&&("doubao"===r&&e.doubao&&e.doubaoEndpointId?t.push("doubao"):"doubao"!==r&&e[r]&&t.push(r)),["deepseek","qwen","glm","gemini"].forEach(o=>{o!==r&&e[o]&&t.push(o)}),t}function g(e){}function f(){return null}},647:(e,t,r)=>{"use strict";r.d(t,{DoubaoVisionClient:()=>c,Y:()=>l});var o=r(5807);function n(e){let t=("string"==typeof e?e:e.message).toLowerCase();return t.includes("api")&&(t.includes("key")||t.includes("密钥"))?"api_key_missing":t.includes("quota")||t.includes("limit")||t.includes("配额")?"api_quota_exceeded":t.includes("timeout")||t.includes("超时")?"api_timeout":t.includes("network")||t.includes("fetch")||t.includes("网络")?"api_network_error":t.includes("too large")||t.includes("过大")?"image_too_large":t.includes("format")||t.includes("格式")?"image_invalid_format":t.includes("corrupted")||t.includes("损坏")?"image_corrupted":t.includes("parse")||t.includes("json")||t.includes("解析")?"parsing_error":"unknown_error"}class i{constructor(e=3,t=1e3,r=1e4){this.maxRetries=e,this.baseDelay=t,this.maxDelay=r}calculateDelay(e){return Math.min(this.baseDelay*Math.pow(2,e-1),this.maxDelay)}shouldRetry(e,t){return!(t>=this.maxRetries)&&!["api_key_missing","api_quota_exceeded","image_too_large","image_invalid_format","image_corrupted"].includes(n(e))}async executeWithRetry(e,t){let r;for(let n=1;n<=this.maxRetries;n++)try{return await e()}catch(e){if(r=e instanceof Error?e:Error("Unknown error"),(0,o.Rm)("warn",`操作失败，尝试 ${n}/${this.maxRetries}`,{error:r.message,attempt:n}),!this.shouldRetry(r,n))break;if(n<this.maxRetries){let e=this.calculateDelay(n);t?.(n,r),(0,o.Rm)("info",`等待 ${e}ms 后重试`,{delay:e,nextAttempt:n+1}),await new Promise(t=>setTimeout(t,e))}}throw r}}function s(e){(0,o.Rm)("error","图片识别错误报告",{errorType:e.errorType,errorMessage:e.errorMessage,imageSize:e.imageSize,apiProvider:e.apiProvider,retryCount:e.retryCount,timestamp:e.timestamp,userAgent:"undefined"!=typeof navigator?navigator.userAgent:"unknown"})}function a(e,t={}){let r="string"==typeof e?e:e.message;return{errorType:n(e),errorMessage:r,timestamp:Date.now(),...t}}class c{constructor(){if(this.apiKey=(0,o.e$)("DOUBAO_API_KEY")||"",this.endpointId=(0,o.e$)("DOUBAO_ENDPOINT_ID")||"doubao-seed-1-6-250615",this.baseUrl="https://ark.cn-beijing.volces.com/api/v3/chat/completions",!this.apiKey)throw Error("豆包API密钥未配置")}isAvailable(){return!!this.apiKey&&!!this.endpointId}async recognizeIngredients(e){if(!this.isAvailable()){let t=Error("豆包API未配置");throw s(a(t,{apiProvider:"doubao",imageSize:e.length})),t}let t=new i(2,1e3,5e3);return await t.executeWithRetry(()=>this.performRecognition(e),(t,r)=>{(0,o.Rm)("warn",`豆包API重试`,{attempt:t,error:r.message,imageSize:e.length})})}async performRecognition(e){let t=`请仔细分析这张图片，识别出其中的所有食材。请按照以下JSON格式返回结果：

{
  "ingredients": ["食材1", "食材2", "食材3"],
  "confidence": 0.95,
  "description": "图片描述",
  "suggestions": ["建议的额外食材"],
  "categories": ["蔬菜", "肉类", "调料"]
}

要求：
1. ingredients数组包含所有能识别出的具体食材名称
2. confidence表示识别的整体置信度(0-1)
3. description简要描述图片内容
4. suggestions可选，推荐可能需要的额外食材
5. categories将食材按类型分类
6. 只返回JSON格式，不要其他文字`,r={model:this.endpointId,messages:[{role:"user",content:[{type:"text",text:t},{type:"image_url",image_url:{url:e,detail:"high"}}]}],max_tokens:1e3,temperature:.1,top_p:.9};try{(0,o.Rm)("info","开始豆包视觉API调用",{model:this.endpointId,imageSize:e.length});let t=await fetch(this.baseUrl,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(r),signal:AbortSignal.timeout(3e4)});if(!t.ok){let e=await t.text();throw(0,o.Rm)("error","豆包API调用失败",{status:t.status,statusText:t.statusText,error:e}),Error(`豆包API调用失败: ${t.status} ${t.statusText}`)}let n=await t.json();if(!n.choices||0===n.choices.length)throw Error("豆包API返回空结果");let i=n.choices[0].message.content;(0,o.Rm)("info","豆包API调用成功",{tokensUsed:n.usage?.total_tokens||0,responseLength:i.length});let s=this.parseRecognitionResult(i);if(!s.ingredients||0===s.ingredients.length)throw Error("未能识别出任何食材");return s}catch(t){if(s(a(t instanceof Error?t:"Unknown error",{apiProvider:"doubao",imageSize:e.length})),(0,o.Rm)("error","豆包视觉API调用异常",{error:t instanceof Error?t.message:"Unknown error",errorType:n(t instanceof Error?t:"Unknown error")}),t instanceof Error){if("AbortError"===t.name)throw Error("请求超时，请重试");switch(n(t)){case"api_key_missing":throw Error("豆包API密钥无效或已过期");case"api_quota_exceeded":throw Error("API调用配额已用完，请稍后重试");case"api_network_error":throw Error("网络连接失败，请检查网络后重试");default:throw t}}throw Error("食材识别失败，请重试")}}parseRecognitionResult(e){try{let t=e.match(/\{[\s\S]*\}/);if(!t)throw Error("响应格式错误");let r=JSON.parse(t[0]);if(!Array.isArray(r.ingredients))throw Error("食材列表格式错误");return{ingredients:r.ingredients.filter(e=>"string"==typeof e&&e.trim().length>0).map(e=>e.trim()).filter((e,t,r)=>r.indexOf(e)===t),confidence:"number"==typeof r.confidence?Math.max(0,Math.min(1,r.confidence)):.8,description:"string"==typeof r.description?r.description.trim():"已识别图片中的食材",suggestions:Array.isArray(r.suggestions)?r.suggestions.filter(e=>"string"==typeof e):[],categories:Array.isArray(r.categories)?r.categories.filter(e=>"string"==typeof e):[]}}catch(t){return(0,o.Rm)("warn","解析豆包响应失败，使用备用解析",{content:e.substring(0,200),error:t instanceof Error?t.message:"Unknown error"}),this.fallbackParseIngredients(e)}}fallbackParseIngredients(e){let t=["土豆","番茄","洋葱","胡萝卜","白菜","菠菜","韭菜","芹菜","豆腐","鸡蛋","鸡肉","猪肉","牛肉","鱼","虾","蟹","大米","面条","面粉","油","盐","糖","醋","酱油","蒜","姜","葱","辣椒","花椒"].filter(t=>e.includes(t));return 0===t.length?{ingredients:e.match(/[\u4e00-\u9fa5]{2,4}/g)?.filter(e=>e.length>=2&&e.length<=4).slice(0,5)||["未知食材"],confidence:.3,description:"图片识别结果不确定，请手动确认",suggestions:[],categories:[]}:{ingredients:t,confidence:.6,description:"从描述中提取的食材信息",suggestions:[],categories:[]}}async testConnection(){if(!this.isAvailable())return{success:!1,message:"豆包API密钥或端点ID未配置"};try{let e={model:this.endpointId,messages:[{role:"user",content:[{type:"text",text:'你好，请回复"连接正常"'}]}],max_tokens:10},t=await fetch(this.baseUrl,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(e),signal:AbortSignal.timeout(1e4)});if(t.ok)return{success:!0,message:"豆包API连接正常"};return{success:!1,message:`连接失败: ${t.status} ${t.statusText}`}}catch(e){return{success:!1,message:`连接异常: ${e instanceof Error?e.message:"Unknown error"}`}}}}function l(){try{return new c}catch(e){return(0,o.Rm)("warn","豆包视觉客户端创建失败",{error:e instanceof Error?e.message:"Unknown error"}),null}}},2907:(e,t,r)=>{"use strict";e.exports=r(5239).vendored["react-rsc"].ReactServerDOMWebpackServerEdge},4856:(e,t,r)=>{"use strict";r.r(t),r.d(t,{API_PROVIDERS:()=>d,clearProviderAPIKey:()=>l,clearStoredAPIKeys:()=>c,getConfiguredProviders:()=>p,getPreferredRecipeProvider:()=>f,getRecipeProviders:()=>m,getStoredAPIKeys:()=>a,hasAnyAPIKey:()=>u,maskAPIKey:()=>n,setPreferredRecipeProvider:()=>g,storeAPIKeys:()=>s,validateAPIKeyFormat:()=>i});var o=r(2907);let n=(0,o.registerClientReference)(function(){throw Error("Attempted to call maskAPIKey() from the server but maskAPIKey is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/zorro/Documents/augment-projects/cooker/recipe-genius/lib/api-key-storage.ts","maskAPIKey"),i=(0,o.registerClientReference)(function(){throw Error("Attempted to call validateAPIKeyFormat() from the server but validateAPIKeyFormat is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/zorro/Documents/augment-projects/cooker/recipe-genius/lib/api-key-storage.ts","validateAPIKeyFormat"),s=(0,o.registerClientReference)(function(){throw Error("Attempted to call storeAPIKeys() from the server but storeAPIKeys is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/zorro/Documents/augment-projects/cooker/recipe-genius/lib/api-key-storage.ts","storeAPIKeys"),a=(0,o.registerClientReference)(function(){throw Error("Attempted to call getStoredAPIKeys() from the server but getStoredAPIKeys is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/zorro/Documents/augment-projects/cooker/recipe-genius/lib/api-key-storage.ts","getStoredAPIKeys"),c=(0,o.registerClientReference)(function(){throw Error("Attempted to call clearStoredAPIKeys() from the server but clearStoredAPIKeys is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/zorro/Documents/augment-projects/cooker/recipe-genius/lib/api-key-storage.ts","clearStoredAPIKeys"),l=(0,o.registerClientReference)(function(){throw Error("Attempted to call clearProviderAPIKey() from the server but clearProviderAPIKey is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/zorro/Documents/augment-projects/cooker/recipe-genius/lib/api-key-storage.ts","clearProviderAPIKey"),u=(0,o.registerClientReference)(function(){throw Error("Attempted to call hasAnyAPIKey() from the server but hasAnyAPIKey is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/zorro/Documents/augment-projects/cooker/recipe-genius/lib/api-key-storage.ts","hasAnyAPIKey"),p=(0,o.registerClientReference)(function(){throw Error("Attempted to call getConfiguredProviders() from the server but getConfiguredProviders is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/zorro/Documents/augment-projects/cooker/recipe-genius/lib/api-key-storage.ts","getConfiguredProviders"),d=(0,o.registerClientReference)(function(){throw Error("Attempted to call API_PROVIDERS() from the server but API_PROVIDERS is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/zorro/Documents/augment-projects/cooker/recipe-genius/lib/api-key-storage.ts","API_PROVIDERS"),m=(0,o.registerClientReference)(function(){throw Error("Attempted to call getRecipeProviders() from the server but getRecipeProviders is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/zorro/Documents/augment-projects/cooker/recipe-genius/lib/api-key-storage.ts","getRecipeProviders"),g=(0,o.registerClientReference)(function(){throw Error("Attempted to call setPreferredRecipeProvider() from the server but setPreferredRecipeProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/zorro/Documents/augment-projects/cooker/recipe-genius/lib/api-key-storage.ts","setPreferredRecipeProvider"),f=(0,o.registerClientReference)(function(){throw Error("Attempted to call getPreferredRecipeProvider() from the server but getPreferredRecipeProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/zorro/Documents/augment-projects/cooker/recipe-genius/lib/api-key-storage.ts","getPreferredRecipeProvider")},5697:(e,t,r)=>{"use strict";r.d(t,{Gf:()=>p,In:()=>i,XV:()=>l,callAI:()=>a,hI:()=>u,jn:()=>s,testDoubaoVisionConnection:()=>d}),r(4856);var o=r(5807),n=r(647);function i(e){let t=[],r={};try{e&&(r={deepseek:e.deepseek,doubao:e.doubao?.key,doubaoEndpointId:e.doubao?.endpointId,qwen:e.qwen,glm:e.glm,gemini:e.gemini})}catch(e){(0,o.Rm)("warn","获取存储的API密钥失败",{error:e instanceof Error?e.message:e})}let n=r.deepseek||(0,o.e$)("DEEPSEEK_API_KEY");n&&t.push({name:"deepseek",baseUrl:"https://api.deepseek.com/chat/completions",model:"deepseek-chat",apiKey:n,headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}});let i=r.doubao||(0,o.e$)("DOUBAO_API_KEY"),s=r.doubaoEndpointId||(0,o.e$)("DOUBAO_ENDPOINT_ID");i&&s&&t.push({name:"doubao",baseUrl:"https://ark.cn-beijing.volces.com/api/v3/chat/completions",model:s,apiKey:i,headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`}});let a=r.qwen||(0,o.e$)("QWEN_API_KEY");a&&t.push({name:"qwen",baseUrl:"https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation",model:"qwen-turbo",apiKey:a,headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}});let c=r.glm||(0,o.e$)("GLM_API_KEY");c&&t.push({name:"glm",baseUrl:"https://open.bigmodel.cn/api/paas/v4/chat/completions",model:"glm-4-flash",apiKey:c,headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`}});let l=r.gemini||(0,o.e$)("GOOGLE_API_KEY");return l&&t.push({name:"gemini",baseUrl:"https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent",model:"gemini-1.5-flash",apiKey:l,headers:{"Content-Type":"application/json"}}),t}async function s(e,t,r){let o=function(e,t){let r=i(e),o=r.filter(e=>"doubao"!==e.name);if(t){let e=r.find(e=>e.name===t);if(e)return[e,...o.filter(e=>e.name!==t)]}let n=[];return["deepseek","qwen","glm","gemini"].forEach(e=>{let t=o.find(t=>t.name===e);t&&n.push(t)}),o.forEach(e=>{n.find(t=>t.name===e.name)||n.push(e)}),n}(t,r);if(0===o.length)throw Error("没有可用的菜谱生成AI提供商，请配置至少一个非豆包的API密钥，或在设置中选择豆包作为菜谱生成模型");return await c(o,e,t)}async function a(e,t){let r=i(t);if(0===r.length)throw Error("没有可用的AI提供商，请配置至少一个API密钥");return await c(r,e,t)}async function c(e,t,r){let o=e[0];try{let e,r;if("gemini"===o.name){if(e=await fetch(`${o.baseUrl}?key=${o.apiKey}`,{method:"POST",headers:o.headers,body:JSON.stringify({contents:[{parts:[{text:t}]}]}),signal:AbortSignal.timeout(6e4)}),r=await e.json(),!e.ok)throw Error(`Gemini API错误: ${r.error?.message||"未知错误"}`);return r.candidates?.[0]?.content?.parts?.[0]?.text||""}if("qwen"===o.name){let n={model:o.model,input:{messages:[{role:"user",content:t}]},parameters:{temperature:.7,max_tokens:2e3}};if(e=await fetch(o.baseUrl,{method:"POST",headers:o.headers,body:JSON.stringify(n),signal:AbortSignal.timeout(3e4)}),r=await e.json(),!e.ok)throw Error(`通义千问API错误: ${r.message||"未知错误"}`);return r.output?.text||""}{let n={model:o.model,messages:[{role:"user",content:t}],temperature:.7,max_tokens:2e3};if(e=await fetch(o.baseUrl,{method:"POST",headers:o.headers,body:JSON.stringify(n),signal:AbortSignal.timeout(6e4)}),r=await e.json(),!e.ok)throw Error(`${o.name} API错误: ${r.error?.message||r.message||"未知错误"}`);return r.choices?.[0]?.message?.content||""}}catch(i){console.error(`AI调用失败 (${o.name}):`,i);let n=e.filter(e=>e.name!==o.name);if(n.length>0){let e=r?{...r}:void 0;return e&&"doubao"===o.name?delete e.doubao:e&&delete e[o.name],c(n,t,e)}throw i}}let l=`
作为一位专业的厨师和营养师，请根据以下信息生成一个详细的菜谱：

食材列表：{ingredients}
饮食偏好：{preferences}
烹饪时间限制：{timeLimit}分钟
用餐人数：{servings}人
难度要求：{difficulty}

请以JSON格式返回菜谱，包含以下字段：
{
  "title": "菜谱名称",
  "description": "简短描述（50字以内）",
  "ingredients": [
    {"name": "食材名", "quantity": "数量", "unit": "单位"}
  ],
  "steps": ["步骤1", "步骤2", "步骤3"],
  "cookingTime": 总烹饪时间(分钟),
  "servings": 份数,
  "difficulty": "easy/medium/hard",
  "nutrition": {
    "calories": 卡路里,
    "protein": 蛋白质(g),
    "carbs": 碳水化合物(g),
    "fat": 脂肪(g),
    "fiber": 纤维(g)
  },
  "tags": ["标签1", "标签2"],
  "tips": ["烹饪小贴士1", "烹饪小贴士2"]
}

请确保：
1. 菜谱实用且可操作
2. 食材用量准确
3. 步骤清晰详细
4. 营养信息合理
5. 只返回JSON，不要其他文字
`,u=`
请分析以下菜谱的营养成分：

菜谱名称：{title}
食材列表：{ingredients}
份数：{servings}

请以JSON格式返回营养分析，包含以下字段：
{
  "calories": 总卡路里,
  "protein": 蛋白质(g),
  "carbs": 碳水化合物(g),
  "fat": 脂肪(g),
  "fiber": 纤维(g),
  "sodium": 钠(mg),
  "sugar": 糖(g),
  "vitamins": ["维生素A", "维生素C"],
  "minerals": ["钙", "铁"],
  "healthScore": 健康评分(1-10),
  "dietaryInfo": ["低脂", "高蛋白", "富含纤维"]
}

请确保营养数据准确合理，只返回JSON格式。
`;async function p(e,t){if(t?.doubao?.key&&t?.doubao?.endpointId)try{let{DoubaoVisionClient:o}=await Promise.resolve().then(r.bind(r,647)),n=Object.create(o.prototype);return n.apiKey=t.doubao.key,n.endpointId=t.doubao.endpointId,n.baseUrl="https://ark.cn-beijing.volces.com/api/v3/chat/completions",await n.recognizeIngredients(e)}catch(e){console.warn("❌ 前端豆包API调用失败，尝试环境变量配置:",e)}let o=(0,n.Y)();if(!o)throw Error("豆包视觉API未配置。请在API设置中配置豆包密钥，或联系管理员配置环境变量。");return await o.recognizeIngredients(e)}async function d(e){try{if(e?.doubao?.key&&e?.doubao?.endpointId){let{DoubaoVisionClient:t}=await Promise.resolve().then(r.bind(r,647)),o=Object.create(t.prototype);return o.apiKey=e.doubao.key,o.endpointId=e.doubao.endpointId,o.baseUrl="https://ark.cn-beijing.volces.com/api/v3/chat/completions",await o.testConnection()}let t=(0,n.Y)();if(!t)return{success:!1,message:"豆包视觉API未配置"};return await t.testConnection()}catch(e){return console.error("❌ 豆包API测试异常:",e),{success:!1,message:`测试失败: ${e instanceof Error?e.message:"Unknown error"}`}}}},5807:(e,t,r)=>{"use strict";function o(){return void 0!==globalThis.caches&&void 0!==globalThis.Request&&void 0!==globalThis.Response&&void 0!==globalThis.fetch}function n(e,t){return o()&&"undefined"!=typeof globalThis?globalThis[e]||t:"undefined"!=typeof process&&process.env&&process.env[e]||t}function i(e){let t=n(e);if(t&&"undefined"!==t&&"null"!==t)return t}r.d(t,{Eb:()=>d,LF:()=>s,QU:()=>u,Rm:()=>l,WX:()=>c,co:()=>a,de:()=>o,e$:()=>i,lh:()=>n,xd:()=>m});function s(e){let t=e.headers,r=e.cf||{};return{id:`req_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:Date.now(),userAgent:t.get("user-agent")||void 0,ip:t.get("cf-connecting-ip")||t.get("x-forwarded-for")||void 0,country:r.country||void 0,region:r.region||void 0,city:r.city||void 0}}function a(e,t,r){let o=new Headers(e.headers);if(Object.entries(t).forEach(([e,t])=>{void 0!==t&&o.set(e,t)}),r?.id&&o.set("X-Request-ID",r.id),r?.timestamp){let e=Date.now()-r.timestamp;o.set("X-Response-Time",`${e}ms`)}return new Response(e.body,{status:e.status,statusText:e.statusText,headers:o})}function c(e,t,r,o){let n={success:!1,error:t,details:r,timestamp:new Date().toISOString(),requestId:o?.id},i={"Content-Type":"application/json","X-Request-ID":o?.id};if(o?.timestamp){let e=Date.now()-o.timestamp;i["X-Response-Time"]=`${e}ms`}return new Response(JSON.stringify(n),{status:e,headers:i})}function l(e,t,r,o){let n={level:e,message:t,timestamp:new Date().toISOString(),requestId:o,metadata:r};switch(e){case"debug":case"info":break;case"warn":console.warn(JSON.stringify(n));break;case"error":console.error(JSON.stringify(n))}}function u(e,t=["*"]){let r=e.headers.get("Origin");if("OPTIONS"===e.method){let e=new Headers;return(t.includes("*")||r&&t.includes(r))&&e.set("Access-Control-Allow-Origin",r||"*"),e.set("Access-Control-Allow-Methods","GET, POST, PUT, DELETE, OPTIONS"),e.set("Access-Control-Allow-Headers","Content-Type, Authorization"),e.set("Access-Control-Max-Age","86400"),new Response(null,{status:204,headers:e})}return null}let p=new Map;function d(e,t=100,r=6e4){let o=Date.now(),n=p.get(e);return!n||o>n.resetTime?(p.set(e,{count:1,resetTime:o+r}),!0):!(n.count>=t)&&(n.count++,!0)}function m(e,t,r){let o=Date.now();return e().then(e=>{let n=Date.now()-o;return l("info",`Performance: ${t} completed in ${n}ms`,{operation:t,duration:n,success:!0},r?.id),e},e=>{let n=Date.now()-o;throw l("error",`Performance: ${t} failed in ${n}ms`,{operation:t,duration:n,success:!1,error:e.message},r?.id),e})}},7987:(e,t,r)=>{Promise.resolve().then(r.bind(r,350))},8315:(e,t,r)=>{Promise.resolve().then(r.bind(r,4856))}};